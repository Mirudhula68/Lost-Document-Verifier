<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="container">
    <h1>Admin Dashboard</h1>
    <p>Welcome, {{ session.name }}</p>
    <a class="btn" href="{{ url_for('logout') }}">Logout</a>
    <h2>Requests</h2>
    <table>
      <tr><th>Name</th><th>Enrollment</th></th><th>Department</th><th>Document</th><th>Year</th><th>Status</th><th>File</th><th>Action</th></tr>
      {% for r in requests %}
      <tr>
        <td>{{ r.name }}<br><small>{{ r.email }}</small></td>
        <td>{{ r.enrollment_no }}</td>
        <td>{{ r.department }}</td>
        <td>{{ r.document_type }}</td>
        <td>{{ r.year_of_issue }}</td>
        <td>{{ r.status }}</td>
        <td>
          {% if r.file_name %}
            <a href="{{ url_for('uploaded_file', filename=r.file_name) }}" target="_blank">Open</a>
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('update_status', req_id=r.id, status='Approved') }}">Approve</a> |
          <a href="{{ url_for('update_status', req_id=r.id, status='Rejected') }}">Reject</a> |
          <a href="{{ url_for('download_certificate', req_id=r.id) }}">Download</a>
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>
</body>
</html>
